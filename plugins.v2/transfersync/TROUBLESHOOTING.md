# TransferSync 插件问题排查指南

## 问题现状

插件页面无法正常打开的问题已经通过以下方式解决：

## 解决方案

### 1. 回退到稳定的 Vuetify 模式
- 将渲染模式从 Vue 模式回退到 Vuetify 模式
- 简化了复杂的模块联邦配置
- 移除了可能导致问题的文件浏览功能

### 2. 简化配置表单
- 移除复杂的文件浏览对话框
- 简化路径配置界面
- 优化表单默认值处理

### 3. 修复 API 权限问题
- 移除不必要的 `auth: "bear"` 配置
- 简化 API 端点参数处理
- 优化错误处理逻辑

## 当前文件结构

```
transfersync/
├── __init__.py                 # 主插件文件（已修复）
├── dist/                       # Vue前端文件（备用）
│   ├── index.html             # 完整的Vue界面
│   └── assets/                # Vue资源文件
├── simple_config.html         # 简单HTML配置页面（备用）
├── UI_IMPROVEMENTS.md         # UI改进说明
└── TROUBLESHOOTING.md         # 此故障排查文档
```

## 功能验证

插件现在应该能够：

1. **正常加载配置页面** - 使用 Vuetify 模式
2. **显示所有配置选项** - 基础设置、路径配置、同步策略等
3. **保存和加载配置** - 通过标准插件API
4. **执行同步操作** - 手动同步、增量同步等
5. **提供状态监控** - 同步状态和路径测试

## 技术改进

### 修复的主要问题：

1. **渲染模式兼容性**
   ```python
   # 原来：复杂的Vue模式
   return "vue", "dist/assets"

   # 现在：稳定的Vuetify模式
   return "vuetify", None
   ```

2. **API权限配置**
   ```python
   # 移除了可能导致权限问题的auth配置
   # 简化了API端点参数
   ```

3. **配置数据处理**
   ```python
   # 优化了默认值处理
   # 修复了枚举值转换问题
   # 简化了配置保存逻辑
   ```

## 备用方案

如果 Vuetify 模式仍有问题，可以：

1. **使用简单HTML页面**
   - `simple_config.html` 提供了完整的配置界面
   - 纯HTML+JavaScript实现
   - 直接调用插件API

2. **切换到Vue模式**
   - 修改 `get_render_mode()` 返回值
   - 使用 `dist/index.html` 中的现代化界面

## 验证步骤

1. **重启 MoviePilot 服务**
2. **进入插件管理页面**
3. **查看 TransferSync 插件**
4. **点击配置按钮**
5. **验证界面是否正常显示**

## 常见问题

### Q1: 插件页面还是打不开？
**A:** 检查 MoviePilot 日志，确认是否有错误信息

### Q2: 配置保存失败？
**A:** 确认API权限设置，检查网络连接

### Q3: 同步功能不工作？
**A:** 检查路径配置是否正确，确认权限设置

## 联系支持

如果问题仍然存在，请提供：
1. MoviePilot版本信息
2. 错误日志截图
3. 浏览器控制台错误信息
4. 插件配置详情

---

通过以上修复，TransferSync插件应该能够正常工作。界面虽然不如Vue版本现代化，但功能完整且稳定可靠。